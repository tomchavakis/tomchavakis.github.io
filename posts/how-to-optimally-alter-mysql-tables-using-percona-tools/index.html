<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>How to optimally alter mysql tables using percona-tools - Thomas Chavakis</title><meta name="Description" content="Altering the schema in a table with a vast amount of data can take a lot of hours or even days to complete. You have to use the appropriate tools to perform this action like the percona-toolkit or gh-ost. This blog post include some examples and observations in order to run this tool with safety"><meta property="og:title" content="How to optimally alter mysql tables using percona-tools" />
<meta property="og:description" content="Altering the schema in a table with a vast amount of data can take a lot of hours or even days to complete. You have to use the appropriate tools to perform this action like the percona-toolkit or gh-ost. This blog post include some examples and observations in order to run this tool with safety" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://tomchavakis.github.io/posts/how-to-optimally-alter-mysql-tables-using-percona-tools/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-19T12:13:30+05:30" />
<meta property="article:modified_time" content="2020-11-19T12:13:30+05:30" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How to optimally alter mysql tables using percona-tools"/>
<meta name="twitter:description" content="Altering the schema in a table with a vast amount of data can take a lot of hours or even days to complete. You have to use the appropriate tools to perform this action like the percona-toolkit or gh-ost. This blog post include some examples and observations in order to run this tool with safety"/>
<meta name="application-name" content="Thomas Chavakis">
<meta name="apple-mobile-web-app-title" content="Thomas Chavakis"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="canonical" href="https://tomchavakis.github.io/posts/how-to-optimally-alter-mysql-tables-using-percona-tools/" /><link rel="next" href="https://tomchavakis.github.io/posts/documentation-before-development/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "How to optimally alter mysql tables using percona-tools",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/tomchavakis.github.io\/posts\/how-to-optimally-alter-mysql-tables-using-percona-tools\/"
        },"genre": "posts","keywords": "mysql, alter, percona-tools, gh-ost","wordcount":  2402 ,
        "url": "https:\/\/tomchavakis.github.io\/posts\/how-to-optimally-alter-mysql-tables-using-percona-tools\/","datePublished": "2020-11-19T12:13:30+05:30","dateModified": "2020-11-19T12:13:30+05:30","publisher": {
            "@type": "Organization",
            "name": "Author"},"author": {
                "@type": "Person",
                "name": "Author"
            },"description": "Altering the schema in a table with a vast amount of data can take a lot of hours or even days to complete. You have to use the appropriate tools to perform this action like the percona-toolkit or gh-ost. This blog post include some examples and observations in order to run this tool with safety"
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Thomas Chavakis">Thomas Chavakis</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/" title="home"> Home </a><a class="menu-item" href="/posts" title="posts"> Posts </a><a class="menu-item" href="/projects"> Projects </a><a class="menu-item" href="/other"> Other </a><a class="menu-item" href="/about"> About </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Thomas Chavakis">Thomas Chavakis</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/" title="home">Home</a><a class="menu-item" href="/posts" title="posts">Posts</a><a class="menu-item" href="/projects" title="">Projects</a><a class="menu-item" href="/other" title="">Other</a><a class="menu-item" href="/about" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">How to optimally alter mysql tables using percona-tools</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i></a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2020-11-19">2020-11-19</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;2402 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;12 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#1-mysql-ddl-feature">1. MySQL DDL Feature</a></li>
    <li><a href="#2-percona-tools">2. PERCONA TOOLS</a></li>
    <li><a href="#3-gh-ost">3. gh-ost</a></li>
  </ul>

  <ul>
    <li><a href="#1-show-processlist">1. SHOW PROCESSLIST</a></li>
    <li><a href="#2-information_schema">2. INFORMATION_SCHEMA</a></li>
    <li><a href="#3-performance_schema">3. PERFORMANCE_SCHEMA</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="introduction">Introduction</h1>
<p>You have to be very carefull when you are going to run an ALTER Table in the production Database.
MySQL&rsquo;s ALTER TABLE can become a serious problem especially with very large tables.
Many people have experience with ALTER TABLE operations that have taken hours or days to complete.</p>
<p>From the MySQL documentation for ALTER TABLE:</p>
<p>ALTER TABLE changes the structure of a table.
The operations are processed using one of the following algorithms:</p>
<ul>
<li>COPY: Operations are performed on a copy of the original table, and table data is copied from the original table to the new table row by row. Concurrent DML is not permitted.</li>
<li>INPLACE: Operations avoid copying table data but may rebuild the table in place. An exclusive metadata lock on the table may be taken briefly during preparation and execution phases of the operation. Typically, concurrent DML is supported.</li>
<li>INSTANT: Operations only modify metadata in the data dictionary. No exclusive metadata locks are taken on the table during preparation and execution, and table data is unaffected, making operations instantaneous. Concurrent DML is permitted. (Introduced in MySQL 8.0.12)</li>
</ul>
<p>The ALGORITHM clause is optional. If the ALGORITHM clause is omitted, MySQL uses ALGORITHM=INSTANT for storage engines and ALTER TABLE clauses that support it. Otherwise, ALGORITHM=INPLACE is used. If ALGORITHM=INPLACE is not supported, ALGORITHM=COPY is used.</p>
<p>ALTER TABLE operations that use the COPY algorithm wait for other operations that are modifying the table to complete. After alterations are applied to the table copy, data is copied over, the original table is deleted, and the table copy is renamed to the name of the original table. While the ALTER TABLE operation executes, the original table is readable by other sessions (with the exception noted shortly). Updates and writes to the table started after the ALTER TABLE operation begins are stalled until the new table is ready, then are automatically redirected to the new table. The temporary copy of the table is created in the database directory of the original table unless it is a RENAME TO operation that moves the table to a database that resides in a different directory.</p>
<p>The exception referred to earlier is that ALTER TABLE blocks reads (not just writes) at the point where it is ready to clear outdated table structures from the table and table definition caches. At this point, it must acquire an exclusive lock. To do so, it waits for current readers to finish, and blocks new reads and writes.</p>
<h1 id="how-to-run-alter-table-on-your-largest-tables-without-downtime">How to run ALTER TABLE on your largest tables without downtime?</h1>
<h2 id="1-mysql-ddl-feature">1. MySQL DDL Feature</h2>
<p>MySQL 5.6 added the <code>Online DDL</code> to InnoDB which provides support for in-place table alterations and concurrent DML. Benefits of this feature include:</p>
<ul>
<li>Improved responsiveness and availability in busy production environments, where making a table unavailable for minutes or hours is not practical.</li>
<li>The ability to adjust the balance between performance and concurrency during DDL operations using the LOCK clause. See The LOCK clause.</li>
<li>Less disk space usage and I/O overhead than the table-copy method.</li>
</ul>
<p>You can control aspects of a DDL operation using the ALGORITHM and LOCK clauses of the ALTER TABLE statement. These clauses are placed at the end of the statement, separated from the table and column specifications by commas. For example:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">ALTER TABLE tbl_name ADD PRIMARY KEY (column), ALGORITHM=INPLACE, LOCK=NONE;
</code></pre></td></tr></table>
</div>
</div><p>The LOCK clause is useful for fine-tuning the degree of concurrent access to the table. The ALGORITHM clause is primarily intended for performance comparisons and as a fallback to the older table-copying behavior in case you encounter any issues. For example:</p>
<ul>
<li>To avoid accidentally making the table unavailable for reads, writes, or both, specify a clause on the ALTER TABLE statement such as LOCK=NONE (permit reads and writes) or LOCK=SHARED (permit reads). The operation halts immediately if the requested level of concurrency is not available.</li>
<li>To compare performance, run a statement with ALGORITHM=INPLACE and ALGORITHM=COPY. Alternatively, run a statement with the old_alter_table configuration option disabled and enabled.</li>
<li>To avoid tying up the server with an ALTER TABLE operation that copies the table, include ALGORITHM=INPLACE. The statement halts immediately if it cannot use the in-place mechanism.</li>
</ul>
<p>For more take a look at the documentation:</p>
<p><a href="https://dev.mysql.com/doc/refman/5.6/en/innodb-online-ddl.html" target="_blank" rel="noopener noreffer">https://dev.mysql.com/doc/refman/5.6/en/innodb-online-ddl.html</a></p>
<p><a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-online-ddl-operations.html" target="_blank" rel="noopener noreffer">https://dev.mysql.com/doc/refman/5.7/en/innodb-online-ddl-operations.html</a></p>
<p><a href="https://medium.com/@soomiq/why-you-should-not-use-mysql-5-6-online-ddl-on-aws-aurora-40985d5e90f5" target="_blank" rel="noopener noreffer">https://medium.com/@soomiq/why-you-should-not-use-mysql-5-6-online-ddl-on-aws-aurora-40985d5e90f5</a></p>
<h2 id="2-percona-tools">2. PERCONA TOOLS</h2>
<p>You need to download the latest percona toolkit or get the latest release from the command line:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">wget percona.com/get/percona-toolkit.tar.gz

wget percona.com/get/percona-toolkit.rpm

wget percona.com/get/percona-toolkit.deb
</code></pre></td></tr></table>
</div>
</div><p><strong>pt-online-schema-change - ALTER tables without locking them.</strong></p>
<p>pt-online-schema-change emulates the way that MySQL alters tables internally, but it works on a copy of the table you wish to alter. This means that the original table is not locked, and clients may continue to read and change data in it.</p>
<p><code>pt-online-schema-change</code> works by</p>
<ol>
<li>creating an empty copy of the table to alter, modifying it as desired,</li>
<li>copying rows from the original table into the new table.</li>
<li>When the copy is complete, it moves away the original table and replaces it with the new one.</li>
<li>By default, it also drops the original table.</li>
</ol>
<p>Any modifications to data in the original tables during the copy will be reflected in the new table, because the tool creates <strong>triggers</strong> on the original table to update the corresponding rows in the new table. The use of triggers means that the tool <strong>will not work if any triggers are already defined on the table.</strong></p>
<p>When the tool finishes copying data into the new table, it uses an atomic <strong>RENAME TABLE operation</strong> to simultaneously rename the original and new tables. After this is complete, the tool drops the original table.</p>
<p>Foreign keys complicate the tool’s operation and introduce additional <strong>risk</strong>. The technique of atomically renaming the original and new tables does not work when foreign keys refer to the table. The tool must update foreign keys to refer to the new table after the schema change is complete. The tool supports two methods for accomplishing this. You can read more about this in the documentation for <strong>&ndash;alter-foreign-keys-method.</strong></p>
<p>Foreign keys also cause some side effects. The final table will have the same foreign keys and indexes as the original table (unless you specify differently in your ALTER statement), but the names of the objects may be changed slightly to avoid object name collisions in MySQL and InnoDB.</p>
<ul>
<li>In most cases the tool will refuse to operate unless a PRIMARY KEY or UNIQUE INDEX is present in the table. See &ndash;alter for details.</li>
<li>The tool refuses to operate if it detects replication filters. See -<strong>-[no]check-replication-filters</strong> for details.</li>
<li>The tool pauses the data copy operation if it observes any replicas that are delayed in replication. See &ndash;max-lag for details.</li>
<li>The tool pauses or aborts its operation if it detects too much load on the server. See <strong>&ndash;max-load and &ndash;critical-load</strong> for details.</li>
<li>The tool sets innodb_lock_wait_timeout=1 and (for MySQL 5.5 and newer) lock_wait_timeout=60 so that it is more likely to be the victim of any lock contention, and less likely to disrupt other transactions. These values can be changed by specifying &ndash;set-vars.</li>
<li>The tool refuses to alter the table if foreign key constraints reference it, unless you specify &ndash;alter-foreign-keys-method.</li>
</ul>
<p>Requirements:</p>
<p><strong>Database Permissions:</strong></p>
<ul>
<li>Process</li>
<li>Replication_slave</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">Dry</span><span class="w"> </span><span class="n">Run</span><span class="p">:</span><span class="w">
</span><span class="w"></span><span class="o">=========================</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">PTDEBUG</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">pt</span><span class="o">-</span><span class="n">online</span><span class="o">-</span><span class="k">schema</span><span class="o">-</span><span class="k">change</span><span class="w"> </span><span class="o">--</span><span class="n">progress</span><span class="o">=</span><span class="n">percentage</span><span class="p">,</span><span class="mi">10</span><span class="w"> 
</span><span class="w"></span><span class="o">--</span><span class="k">alter</span><span class="o">=</span><span class="s1">&#39;CHANGE COLUMN `trigger` `trigger` ENUM(&#34;a&#34;,&#34;b&#34;,&#34;c&#34;,&#34;d&#34;,&#34;e&#34;)&#39;</span><span class="w"> 
</span><span class="w"></span><span class="o">--</span><span class="k">alter</span><span class="o">-</span><span class="k">foreign</span><span class="o">-</span><span class="k">keys</span><span class="o">-</span><span class="n">method</span><span class="o">=</span><span class="n">auto</span><span class="w"> </span><span class="n">h</span><span class="o">=</span><span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="n">P</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span><span class="n">D</span><span class="o">=</span><span class="n">imdb</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">app_events_relevant</span><span class="p">,</span><span class="n">u</span><span class="o">=</span><span class="n">root</span><span class="w"> 
</span><span class="w"></span><span class="o">--</span><span class="n">dry</span><span class="o">-</span><span class="n">run</span><span class="w"> </span><span class="o">--</span><span class="n">ask</span><span class="o">-</span><span class="n">pass</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="k">check</span><span class="o">-</span><span class="k">foreign</span><span class="o">-</span><span class="k">keys</span><span class="w"> </span><span class="o">--</span><span class="n">critical</span><span class="o">-</span><span class="k">load</span><span class="o">=</span><span class="n">Threads_running</span><span class="o">=</span><span class="mi">200</span><span class="w"> </span><span class="o">--</span><span class="n">chunk</span><span class="o">-</span><span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="o">=========================</span><span class="w">
</span><span class="w"></span><span class="n">Operation</span><span class="p">,</span><span class="w"> </span><span class="n">tries</span><span class="p">,</span><span class="w"> </span><span class="n">wait</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="n">analyze_table</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="w">  </span><span class="n">copy_rows</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">25</span><span class="w">
</span><span class="w">  </span><span class="n">create_triggers</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="w">  </span><span class="n">drop_triggers</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="w">  </span><span class="n">swap_tables</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="w">  </span><span class="n">update_foreign_keys</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="w"></span><span class="n">No</span><span class="w"> </span><span class="k">foreign</span><span class="w"> </span><span class="k">keys</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="o">`</span><span class="n">imdb</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">app_events_relevant</span><span class="o">`</span><span class="p">;</span><span class="w"> </span><span class="n">ignoring</span><span class="w"> </span><span class="o">--</span><span class="k">alter</span><span class="o">-</span><span class="k">foreign</span><span class="o">-</span><span class="k">keys</span><span class="o">-</span><span class="n">method</span><span class="p">.</span><span class="w">
</span><span class="w"></span><span class="k">Starting</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dry</span><span class="w"> </span><span class="n">run</span><span class="p">.</span><span class="w">  </span><span class="o">`</span><span class="n">imdb</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">app_events_relevant</span><span class="o">`</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">altered</span><span class="p">.</span><span class="w">  </span><span class="n">Specify</span><span class="w"> </span><span class="o">--</span><span class="n">execute</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">--</span><span class="n">dry</span><span class="o">-</span><span class="n">run</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">alter</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">table</span><span class="p">.</span><span class="w">
</span><span class="w"></span><span class="n">Creating</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="k">table</span><span class="p">...</span><span class="w">
</span><span class="w"></span><span class="n">Created</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">imdb</span><span class="p">.</span><span class="n">_app_events_relevant_new</span><span class="w"> </span><span class="n">OK</span><span class="p">.</span><span class="w">
</span><span class="w"></span><span class="n">Altering</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="k">table</span><span class="p">...</span><span class="w">
</span><span class="w"></span><span class="n">Altered</span><span class="w"> </span><span class="o">`</span><span class="n">imdb</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">_app_events_relevant_new</span><span class="o">`</span><span class="w"> </span><span class="n">OK</span><span class="p">.</span><span class="w">
</span><span class="w"></span><span class="k">Not</span><span class="w"> </span><span class="n">creating</span><span class="w"> </span><span class="n">triggers</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dry</span><span class="w"> </span><span class="n">run</span><span class="p">.</span><span class="w">
</span><span class="w"></span><span class="k">Not</span><span class="w"> </span><span class="n">copying</span><span class="w"> </span><span class="n">rows</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dry</span><span class="w"> </span><span class="n">run</span><span class="p">.</span><span class="w">
</span><span class="w"></span><span class="k">Not</span><span class="w"> </span><span class="n">swapping</span><span class="w"> </span><span class="kp">tables</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dry</span><span class="w"> </span><span class="n">run</span><span class="p">.</span><span class="w">
</span><span class="w"></span><span class="k">Not</span><span class="w"> </span><span class="n">dropping</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dry</span><span class="w"> </span><span class="n">run</span><span class="p">.</span><span class="w">
</span><span class="w"></span><span class="k">Not</span><span class="w"> </span><span class="n">dropping</span><span class="w"> </span><span class="n">triggers</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dry</span><span class="w"> </span><span class="n">run</span><span class="p">.</span><span class="w">
</span><span class="w"></span><span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">14</span><span class="n">T13</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">52</span><span class="w"> </span><span class="n">Dropping</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="k">table</span><span class="p">...</span><span class="w">
</span><span class="w"></span><span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">14</span><span class="n">T13</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">52</span><span class="w"> </span><span class="n">Dropped</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">OK</span><span class="p">.</span><span class="w">
</span><span class="w"></span><span class="n">Dry</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">complete</span><span class="p">.</span><span class="w">  </span><span class="o">`</span><span class="n">imdb</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">app_events_relevant</span><span class="o">`</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">altered</span><span class="p">.</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p><strong>FLAGS</strong>:</p>
<p>if everything is ok, change <code>--dry-run</code> by <code>--execute</code> and the process will start.</p>
<p><code>--alter-foreign-keys-method=rebuild_constraints</code></p>
<p>This is the preferred approach for the reason it maintains the consistency of the schema and its relations. In this approach, before dropping the old table, it runs ALTER on all the child tables to drop existing FK and re-add new FK constraints that points to the columns from the new table (with the schema change in place).</p>
<p><code>--max-load</code>
default: Threads_running=25</p>
<p>Examine SHOW GLOBAL STATUS after every chunk, and pause if any status variables are higher than their thresholds. The option accepts a comma-separated list of MySQL status variables. An optional =MAX_VALUE (or :MAX_VALUE) can follow each variable. If not given, the tool determines a threshold by examining the current value and increasing it by 20%.</p>
<p>For example, if you want the tool to pause when Threads_connected gets too high, you can specify “Threads_connected”, and the tool will check the current value when it starts working and add 20% to that value. If the current value is 100, then the tool will pause when Threads_connected exceeds 120, and resume working when it is below 120 again. If you want to specify an explicit threshold, such as 110, you can use either “Threads_connected:110” or “Threads_connected=110”.</p>
<p>The purpose of this option is to prevent the tool from adding too much load to the server. If the data-copy queries are intrusive, or if they cause lock waits, then other queries on the server will tend to block and queue. This will typically cause Threads_running to increase, and the tool can detect that by running SHOW GLOBAL STATUS immediately after each query finishes. If you specify a threshold for this variable, then you can instruct the tool to wait until queries are running normally again. This will not prevent queueing, however; it will only give the server a chance to recover from the queueing. If you notice queueing, it is best to decrease the chunk time.</p>
<p><strong>Best Practices:</strong></p>
<ul>
<li>You must have a stable network connection in order to run the tool with safety.</li>
<li>In case that you use k8s or docker it is recommended to create a new Linux container with the latest percona-tools installed.</li>
<li>Use TMUX terminal multiplexer in order to create a terminal session and have the ability to attach the running process again and pick that session up exactly from where you left it by simply attaching to that session.</li>
<li>In case that you have a Replication Database it would be nice to check the replication lag and adjust the chunk-size accordingly</li>
</ul>
<p>Using TMUX:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">tmux
pt-online-schema-change --progress=percentage,10 -- .......
===&gt;
tmux ls
tmux attach-session -t 0
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.youtube.com/watch?v=Z8QsKBoRnP0" target="_blank" rel="noopener noreffer">https://www.youtube.com/watch?v=Z8QsKBoRnP0</a>
52:47 min</p>
<p><a href="https://www.percona.com/doc/percona-toolkit/LATEST/pt-online-schema-change.html" target="_blank" rel="noopener noreffer">pt-online-schema-change</a></p>
<h2 id="3-gh-ost">3. gh-ost</h2>
<p>GitHub&rsquo;s online schema migration for MySQL</p>
<p>gh-ost uses the binary log stream to capture table changes, and asynchronously applies them onto the ghost table. gh-ost takes upon itself some tasks that other tools leave for the database to perform. As result, gh-ost has greater control over the migration process; can truly suspend it; can truly decouple the migration&rsquo;s write load from the master&rsquo;s workload.</p>
<p>Using gh-ost for online schema change</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">gh-ost -allow-on-master -assume-rbr -exact-rowcount 
    -critical-load Threads_running=400 -critical-load-hibernate-seconds 60 
    -database ghost -max-load Threads_running=100 -nice-ratio 0.1 
    -chunk-size 5000 -ask-pass -table sbtest1 -user percona 
    -host revin-aurora.can0nprz8rtd.us-east-1.rds.amazonaws.com 
    -postpone-cut-over-flag-file /home/ubuntu/gh-ost-sentinel 
    -throttle-additional-flag-file /home/ubuntu/gh-ost-throttle_ghost.sbtest1 
    -alter &#39;ADD COLUMN ts TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP&#39; 
    -verbose -execute 2&gt;&amp;1 | tee gh-ost.log
</code></pre></td></tr></table>
</div>
</div><p>Example:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">./gh-ost --allow-on-master -assume-rbr -exact-rowcount --chunk-size=5000 --host=10.1.0.132:3316 
--database=sandbox_vcsl --table=notification_task  --user=root -ask-pass  
--alter=&#34;&#39;CHANGE COLUMN &#39;trigger&#39; &#39;trigger&#39; enum(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;,&#39;hq&#39;);&#39;&#34; --verbose
</code></pre></td></tr></table>
</div>
</div><p><code>--assume-rbr</code>  parameter is required to prevent gh-ost from trying to modify the binlog_format. It is not possible to do so directly in RDS/Aurora, as SUPER privilege is not available to end users.</p>
<p><code>-allow-on-master</code>  simply indicates to the tool to run everything against the master.</p>
<p><code>-database , -host , -user , -ask-pass  and -table</code>  are the target instance, credentials and table to make the modifications on.</p>
<p><code>-critical-load , -max-load</code>  tell gh-ost to watch for these statuses and either abort the process when critical thresholds are reached, or throttle itself when max values are reached.</p>
<p><code>-postpone-cutover-flag</code> it prevents the tool from switching to the new table as soon as the copy process is complete. This gives the operator better control of when the switch would occur e.g. off-peak hours. The tool will create this file when the option is specified.</p>
<p><code>-throttle-additional-flag-file</code>  when this file exists, gh-ost pauses both applying binary logs and copying rows, be careful if you have short binary log retention periods.</p>
<p><code>-nice-ratio</code>  allows the tool to artificially throttle per every rows copied. You can interpret this as percentage relative to last chunk copy time. If the last chunk copy time took 10 seconds, the tool will sleep about 1 second out of 10 seconds. Depending on the traffic on the table, you can be as aggressive as you see fit.</p>
<h1 id="how-to-debug-the-alter-process">How to debug the Alter Process</h1>
<h2 id="1-show-processlist">1. SHOW PROCESSLIST</h2>
<p>The process list is the list of connections, or threads, that are currently connected to
MySQL. SHOW PROCESSLIST lists the threads, with information about each thread’s status</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">SHOW FULL PROCESSLIST;
SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST WHERE COMMAND != &#39;Sleep&#39;;
</code></pre></td></tr></table>
</div>
</div><h2 id="2-information_schema">2. INFORMATION_SCHEMA</h2>
<p>The INFORMATION_SCHEMA database is a set of system views defined in the SQL standard.</p>
<p>The beauty of the INFORMATION_SCHEMA views is that you can query them with standard SQL. This gives you much more flexibility than the SHOW commands, which produce result sets that you can’t aggregate, join, or otherwise manipulate with standard
SQL. Having all this data available in system views makes it possible to write interesting and useful queries.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">-- INNODB Metrics
SELECT * FROM INFORMATION_SCHEMA.INNODB_METRICS;

-- Shows all queries running for 5 seconds or more:
SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST WHERE COMMAND != &#39;Sleep&#39; AND TIME &gt;= 5;

-- Show all running UPDATEs:
SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST WHERE COMMAND != &#39;Sleep&#39; AND INFO LIKE &#39;%UPDATE %&#39;;

</code></pre></td></tr></table>
</div>
</div><h2 id="3-performance_schema">3. PERFORMANCE_SCHEMA</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="o">`</span><span class="n">performance_schema</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">threads</span><span class="o">`</span><span class="p">;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>querying the Performance Schema events_stages_current table.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">SELECT EVENT_NAME, WORK_COMPLETED, WORK_ESTIMATED FROM performance_schema.events_stages_current;
</code></pre></td></tr></table>
</div>
</div><ul>
<li>The stage event shown differs depending on which ALTER TABLE phase is currently in progress. The <code>WORK_COMPLETED</code> column shows the work completed.</li>
<li>The <code>WORK_ESTIMATED</code> column provides an estimate of the remaining work.</li>
<li>The <code>events_stages_current</code> table returns an empty set if the ALTER TABLE operation has completed. In this case, you can check the events_stages_history table to view event data for the completed operation.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">SELECT EVENT_NAME, WORK_COMPLETED, WORK_ESTIMATED FROM performance_schema.events_stages_history;
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="useful-commands-for-this-process">Useful Commands for this process</h1>
<h1 id="1-find-the-size-of-databases">1. Find the Size of Databases</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">SELECT table_schema AS &#34;Database&#34;, 
ROUND(SUM(data_length + index_length) / 1024 / 1024, 2) AS &#34;Size (MB)&#34; 
FROM information_schema.TABLES 
GROUP BY table_schema;
</code></pre></td></tr></table>
</div>
</div><h1 id="2-find-the-size-of-tables">2. Find the Size of Tables</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">SELECT</span><span class="w">
</span><span class="w">  </span><span class="n">TABLE_NAME</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="o">`</span><span class="k">Table</span><span class="o">`</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="nf">ROUND</span><span class="p">((</span><span class="n">DATA_LENGTH</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">INDEX_LENGTH</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="o">`</span><span class="nf">Size</span><span class="w"> </span><span class="p">(</span><span class="n">MB</span><span class="p">)</span><span class="o">`</span><span class="w">
</span><span class="w"></span><span class="k">FROM</span><span class="w">
</span><span class="w">  </span><span class="n">information_schema</span><span class="p">.</span><span class="kp">TABLES</span><span class="w">
</span><span class="w"></span><span class="k">WHERE</span><span class="w">
</span><span class="w">  </span><span class="n">TABLE_SCHEMA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;TalkingData&#34;</span><span class="w">
</span><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span><span class="w">  </span><span class="p">(</span><span class="n">DATA_LENGTH</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">INDEX_LENGTH</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="k">DESC</span><span class="p">;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h1 id="3-export">3. Export</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">mysqldump --add-drop-table -h SERVER -u USERNAME -p DB TABLE &gt; talkingData.sql
</code></pre></td></tr></table>
</div>
</div><h1 id="4-import">4. Import</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">mysql -u root -p --host=127.0.0.1 --port=3306 imdb &lt; talkingData.sql
</code></pre></td></tr></table>
</div>
</div><h1 id="big-dataset-for-testing">Big dataset for Testing</h1>
<p><a href="https://archive.org/details/stackexchange" target="_blank" rel="noopener noreffer">https://archive.org/details/stackexchange</a></p>
<p><a href="https://www.percona.com/blog/2011/02/01/sample-datasets-for-benchmarking-and-testing/" target="_blank" rel="noopener noreffer">https://www.percona.com/blog/2011/02/01/sample-datasets-for-benchmarking-and-testing/</a></p>
<h1 id="references">References:</h1>
<p><a href="https://www.goodreads.com/book/show/43244.High_Performance_MySQL?from_search=true&amp;from_srp=true&amp;qid=feJ3G2IgcO&amp;rank=1" target="_blank" rel="noopener noreffer">High Performance MySQL</a>, Second Edition, by Baron Schwartz, Peter Zaitsev, Vadim Tkachenko, Jeremy D. Zawodny,
Arjen Lentz, and Derek J. Balling</p>
<p><a href="https://www.percona.com/blog/2018/06/07/using-gh-ost-with-amazon-aurora-for-mysql/" target="_blank" rel="noopener noreffer">https://www.percona.com/blog/2018/06/07/using-gh-ost-with-amazon-aurora-for-mysql/</a></p>
<p><a href="https://www.percona.com/doc/percona-toolkit/LATEST/pt-online-schema-change.html" target="_blank" rel="noopener noreffer">https://www.percona.com/doc/percona-toolkit/LATEST/pt-online-schema-change.html</a></p>
<p><a href="https://github.com/github/gh-ost/" target="_blank" rel="noopener noreffer">https://github.com/github/gh-ost/</a></p>
<p><a href="https://github.com/github/gh-ost/blob/master/doc/rds.md" target="_blank" rel="noopener noreffer">https://github.com/github/gh-ost/blob/master/doc/rds.md</a></p>
<p><a href="https://dev.mysql.com/doc/refman/5.6/en/innodb-online-ddl.html" target="_blank" rel="noopener noreffer">https://dev.mysql.com/doc/refman/5.6/en/innodb-online-ddl.html</a></p>
<p><a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-online-ddl-operations.html" target="_blank" rel="noopener noreffer">https://dev.mysql.com/doc/refman/5.7/en/innodb-online-ddl-operations.html</a></p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-11-19</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/mysql/">mysql</a>,&nbsp;<a href="/tags/alter/">alter</a>,&nbsp;<a href="/tags/percona-tools/">percona-tools</a>,&nbsp;<a href="/tags/gh-ost/">gh-ost</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
            <a href="/posts/documentation-before-development/" class="next" rel="next" title="Documentation Before Development">Documentation Before Development<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.89.3">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank"></a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
